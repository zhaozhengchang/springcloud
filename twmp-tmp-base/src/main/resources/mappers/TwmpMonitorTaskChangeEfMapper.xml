<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ceiec.twmp.tmp.mapper.TwmpMonitorTaskChangeEfMapper" >
  <resultMap id="BaseResultMap" type="com.ceiec.twmp.tmp.entity.TwmpMonitorTaskChangeEf" >
    <!--
      WARNING - @mbg.generated
    -->
    <id column="task_change_id" property="taskChangeId" jdbcType="BIGINT" />
    <result column="device_id" property="deviceId" jdbcType="BIGINT" />
    <result column="device_number" property="deviceNumber" jdbcType="VARCHAR" />
    <result column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="person_name" property="personName" jdbcType="VARCHAR" />
    <result column="task_code" property="taskCode" jdbcType="VARCHAR" />
    <result column="task_name" property="taskName" jdbcType="VARCHAR" />
    <result column="task_level" property="taskLevel" jdbcType="TINYINT" />
    <result column="task_status" property="taskStatus" jdbcType="TINYINT" />
    <result column="document_url" property="documentUrl" jdbcType="VARCHAR" />
    <result column="start_time" property="startTime" jdbcType="TIMESTAMP" />
    <result column="end_time" property="endTime" jdbcType="TIMESTAMP" />
    <result column="task_reason" property="taskReason" jdbcType="VARCHAR" />
    <result column="report_location" property="reportLocation" jdbcType="VARCHAR" />
    <result column="report_start_time" property="reportStartTime" jdbcType="TIMESTAMP" />
    <result column="report_end_time" property="reportEndTime" jdbcType="TIMESTAMP" />
    <result column="report_time" property="reportTime" jdbcType="TIMESTAMP" />
    <result column="report_time_interval" property="reportTimeInterval" jdbcType="TIMESTAMP" />
    <result column="department_id" property="departmentId" jdbcType="BIGINT" />
    <result column="department_name" property="departmentName" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="creator_id" property="creatorId" jdbcType="BIGINT" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="updater" property="updater" jdbcType="VARCHAR" />
    <result column="updater_id" property="updaterId" jdbcType="BIGINT" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="deleted" property="deleted" jdbcType="TINYINT" />
  </resultMap>

  <resultMap id="MonitorTaskDetailQueryResult"  type="com.ceiec.twmp.tmp.vo.monitor.result.MonitorTaskDetailQueryResultVO" >
    <id column="task_id" property="taskId" jdbcType="BIGINT" />
    <result column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="person_name" property="personName" jdbcType="VARCHAR" />
    <result column="person_former_name" property="formerName" jdbcType="VARCHAR" />
    <result column="person_number" property="personNumber" jdbcType="VARCHAR" />
    <result column="person_url" property="personUrl" jdbcType="VARCHAR" />
    <result column="birth_date" property="birthDate" jdbcType="VARCHAR" />
    <result column="gender" property="gender" jdbcType="TINYINT" />
    <result column="marital_status" property="maritalStatus" jdbcType="TINYINT" />
    <result column="person_id_card" property="personIdCard" jdbcType="VARCHAR" />
    <result column="department_id" property="departmentId" jdbcType="BIGINT" />
    <result column="phone" property="phone" jdbcType="VARCHAR" />
    <result column="career" property="career" jdbcType="VARCHAR" />
    <result column="address" property="address" jdbcType="VARCHAR" />
    <result column="task_code" property="taskCode" jdbcType="VARCHAR" />
    <result column="start_time" property="startTimeDate" jdbcType="TIMESTAMP" />
    <result column="end_time" property="endTimeDate" jdbcType="TIMESTAMP" />
    <result column="task_level" property="taskLevel" jdbcType="TINYINT" />
    <result column="document_url" property="documentUrl" jdbcType="TINYINT" />
    <result column="task_reason" property="taskReason" jdbcType="VARCHAR" />
    <result column="report_start_time" property="reportStartTimeDate" jdbcType="TIMESTAMP" />
    <result column="report_end_time" property="reportEndTimeDate" jdbcType="TIMESTAMP" />
    <result column="report_time_interval" property="reportTimeInterval" jdbcType="INTEGER" />
    <result column="report_location" property="reportLocation" jdbcType="VARCHAR" />
    <result column="report_time" property="reportTimeDate" jdbcType="TIMESTAMP" />
    <collection property="criminalEfList" ofType="com.ceiec.twmp.tmp.entity.TwmpBsPersonCriminalEf" >
      <id column="criminal_id" property="criminalId" jdbcType="BIGINT"/>
      <result column="criminal_type" property="criminalType" jdbcType="INTEGER"/>
      <result column="criminal_time" property="criminalTime" jdbcType="TIMESTAMP"/>
      <result column="criminal_site" property="criminalSite" jdbcType="VARCHAR"/>
      <result column="criminal_act" property="criminalAct" jdbcType="VARCHAR"/>
      <result column="law_enforcement_agency" property="lawEnforcementAgency" jdbcType="VARCHAR"/>
      <result column="dispose_time" property="disposeTime" jdbcType="TIMESTAMP" />
      <result column="dispose_result" property="disposeResult" jdbcType="VARCHAR"/>
      <result column="criminal_number" property="criminalNumber" jdbcType="VARCHAR"/>
    </collection>
  </resultMap>

  <select id="getMonitorTaskDetail" parameterType="com.ceiec.twmp.tmp.vo.monitor.query.MonitorTaskDetailQueryVO" resultMap="MonitorTaskDetailQueryResult">
      select t.task_change_id task_id,
        p.person_name person_name, p.person_id person_id, p.person_url person_url, p.person_former_name person_former_name,
        p.person_number person_number, p.birth_date birth_date, p.gender gender, p.marital_status marital_status, p.person_id_card person_id_card,
        p.department_id department_id, p.phone phone, p.career career, p.address address,
        c.criminal_id criminal_id, c.criminal_type criminal_type, c.criminal_time criminal_time, c.criminal_site criminal_site,
        c.criminal_act criminal_act, c.law_enforcement_agency law_enforcement_agency, c.dispose_time dispose_time,
        c.dispose_result dispose_result, c.criminal_number criminal_number,
        t.task_level task_level, t.task_code task_code, t.start_time start_time, t.end_time end_time, t.document_url document_url,
        t.task_reason task_reason, t.report_start_time report_start_time, t.report_end_time report_end_time,
        t.report_time_interval  report_time_interval, t.report_location report_location, t.report_time report_time
      from twmp_monitor_task_change_ef t
      left outer join twmp_bs_person_ef p on t.person_id = p.person_id
      left outer join twmp_bs_person_criminal_ef c on t.person_id = c.person_id
      where t.deleted = 1
      and p.deleted = 1
      and c.deleted = 1
      and t.task_change_id = #{taskId}
  </select>
</mapper>